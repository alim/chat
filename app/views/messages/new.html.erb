<h1>Post New Message</h1>

<turbo-frame id="new_message" target="_top">

  <%#
    The model: [@message.room, @message] specifies a nested model, where the
    messages are nested within a room object.

    data: { controller: "reset-form", action: "turbo:submit-end->reset-form#reset" }:
    This option sets custom attributes on the form element using a hash.
    Here's what it does:

      controller: "reset-form": This defines a JavaScript controller named
      "reset-form" that will handle the form submission.

      action: "turbo:submit-end->reset-form#reset": This specifies an action to be
      triggered by the JavaScript controller. Here, it uses Turbo Streams
      syntax (turbo:submit-end) which fires after a form submission using
      Turbo Frames is completed. The subsequent part (->reset-form#reset)
      calls the reset method of the javascript controller.
  %>

  <%= form_with(model: [@message.room, @message],
  data:{ controller: "reset-form", action: "turbo:submit-end->reset-form#reset"}) do |form| %>
    <div class="field">
      <%= form.text_field :content %>
      <%= form.submit "Send"%>
    </div>
  <% end %>

</turbo-frame>
<%= link_to 'Back', @message.room %>
